#summary Installation Guide

= Installing Ruby PDNS =
== Overview ==
As it's pretty early days for the code base it's only been used on CentOS 5.3 using the Epel RPMs for PowerDNS.

I don't doubt that what I've built will work perfectly fine on other operating systems and will try to update the documentation for other Operating Systems as we get more widespread use.

== Requirements ==
 * A recent [http://www.powerdns.com/ PowerDNS] server with the Pipe backend, we test against 2.9.22 at time of writing
 * Ruby, tested against 1.8.5 as provided by CentOS 5.3
 * [http://www.maxmind.com/app/ruby Maxmind's Ruby GeoIP] plugin
 * GeoIP and GeoIP Data, CentOS provide RPMs in their Extras repository for this

== Install PowerDNS ==
I am not going to cover the install of PowerDNS in detail, you should get PowerDNS and PowerDNS Pipe Backend installed, on the CentOS machines I used the packages from [https://fedoraproject.org/wiki/EPEL EPEL] for this.

Refer to the [http://doc.powerdns.com/ PowerDNS documentation] for full install details, most distributions of Linux should provide pdns packages already too.

== Install Ruby PDNS ==
In the current release - 0.3 as of time of writing - we provide a RedHat Source RPM, noarch RPM and a .tgz file with the code, the RPMs will install themselves just fine, for the tar ball there's a manual process, I'll cover both.

=== Installing using RPM ===
 * Get the RPM from the [http://code.google.com/p/ruby-pdns/downloads/list download list]
 * Install once you've met all the listed requirements above simply install the rpm using _rpm -ivh ruby-pdns-0.3rc1-46.el5.noarch.rpm_
 * The RPM will set up log directories in _/var/log/pdns_ and install all the needed libraries into the Ruby site directory etc, it will also install a config file and sample records.

=== Installing using the source ===
As mentioned this is a bit of a manual process today we're likely to provide a Gem or something in future, basic steps once PowerDNS has been installed should be:

You need to know ahead of time:
 * Your ruby site library path, you can find this using: _ruby -rrbconfig -e "puts Config::CONFIG['sitelibdir']"_
 * The username your pdns runs as, generally this is pdns

Now do:
 * Create directory _/etc/pdns/records_ 
 * Create directory _/var/log/pdns_ owned by _pdns:pdns_
 * Extract the tar file into a temp directory
 * Copy _records/`*`_ to _/etc/pdns/records_
 * Copy _pdns.rb_ to your ruby _sitelibdir_
 * Create _sitelibdir/pdns_
 * Copy _pdns/`*`_ to _sitelibdir/pdns/_
 * Copy _pdns-pipe-runner.rb_ to _/usr/sbin/_ and mark it executable
 * Copy _etc/pdns-ruby-backend-dist.cfg_ to _/etc/pdns/pdns-ruby-backend.cfg_

This should more or less get you up to the same place as simply installing the RPM

=== Configuring Ruby PDNS ===
You now need to tune the _/etc/pdns/pdns-ruby-backend.cfg_ to your tastes, the defaults given should be fairly obvious and would work out the box on a CentOS machine.  See the full [RPDNSConfigurationGuide Ruby PDNS Configuration Guide] for details on all the possible settings.

=== Integrating with PowerDNS ===
In the simplest case where you use PowerDNS just to serve records answered by this system you'd only adjust these settings in _/etc/pdns/pdns.conf_

{{{
launch=pipe
pipe-command=/usr/sbin/pdns-pipe-runner.rb
pipebackend-abi-version=2
}}}

There are a whole list of other settings though to tune, please see both our guide on [PDNSConfigurationGuide PowerDNS settings that we've found useful] and the [http://docs.powerdns.org/ official docs].